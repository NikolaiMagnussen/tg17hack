import gmpy2
from Crypto.Util.number import bytes_to_long, long_to_bytes

p = 25447604191089399379159931601501080444223112829447986750317096149517867285845804966271224749129184435412473271409883249120061873968316995978986208798525834614270065406921367971958806946394627934176702490478759393791972348471983612822611594685811932943967049526367295051671357595632868487646701478129716574546371021473575044516208082932409236271197813454910887142831892249406409490190907510457662553380813454668746280863597454887291739055374694568403834521593202067598993705171014838010676808696015931234887447378008864624871506336318997332815619367547971665857733583462023685385857017492039424076060074104480283422433
q = 25447604191089399379159931601501080444223112829447986750317096149517867285845804966271224749129184435412473271409883249120061873968316995978986208798525834614270065406921367971958806946394627934176702490478759393791972348471983612822611594685811932943967049526367295051671357595632868487646701478129716574546371021473575044516208082932409236271197813454910887142831892249406409490190907510457662553380813454668746280863597454887291739055374694568403834521593202067598993705171014838010676808696015931234887447378008864624871506336318997332815619367547971665857733583462023685385857017492039424076060074104480283423261
n = 647580559066350764512574139212258654419619377791696792933162647847016182264786947024323483613445156926567953673211035865775396889491136493021394983865794529477091872229948860215774356455333826515720143910504339782998354975787558272036453370109286642626999091302012693562994565167763421804705602666440082138719409120664293876204553614511882382199434919365954997082834057119072868066696185230896273866269308019520562618860020221768639470528300841159704088859374399286986458302241337120121430937058280863472916553328255990461105886678126859657320418919609691089677744300138990131567897731188913573095161012997609872471436323858576012929455006921387033623358406327954425701649820631580290471076284227572599505740170534938538303275799383217459413578897504327360744415747939112249827320135553789275968404788584789483305709222531189435482276931098037440920811828069795012367922134191531348046137386595744872323763751900274523135348273825558806037832123609238684829315071013742451094194097286985647180549444633529585827947422469423955056342229557961062943802754823402381380268562309956425582717559687406317915547051766896665477764999756658000565784673316779579644624160889528487904071313946671365415309957045804828537561845474437630201414013
d = 431720372710900509675049426141505769613079585194464528622108431898010788176524631349548989075630104617711969115474023910516931259660757662014263322577196352984727914819965906810516237636889217677146762607002893188665569983858372181357635580072857761751332727534675129041996376778508947869803735110960054759146272747109529250803035743007921588132956612910636664721889371412715245377797456820597515910846205346347041745906680147845759647018867227439802725906249599524657638868160891413414287291372187242315277702218837326974070591118751239771546945946406460726451829533425993421045265154125942382063440675331739914980923619100129222753797791372122687641646640068197019818766124292854169824336395078426704704161274777378475571155319744479479526553973913556935181332100591628680858126214474035554700527263863689076634869494382447098598888156102713476850392425798780764319992023425864505295196447602986090232313565962676726657503687855074437299199804962249244237848450257888419546605622334991222907712708545672447001893773895009745042520334908700858906883096049342163048399679415701526923153432896917761262795622916576535338660070000426847544027773762761056652661948102955029714903897853164878696358828673880499792939816884152446423045547
e = 3

flag = "TG17{t00_cl0se_f0r_g00d_crypt0}"

m = bytes_to_long(flag)
print "plain: {}".format(m)
c = gmpy2.powmod(m, e, n)
print "ciphertext: {}".format(c)

p = gmpy2.powmod(c, d, n)
print "decrypted: {}".format(long_to_bytes(p))
